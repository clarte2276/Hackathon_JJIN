{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{Link,useLocation}from\"react-router-dom\";import axios from\"axios\";import TitleBody from\"./element/TitleBody.js\";import List from\"./element/List.js\";import ColumnList from\"./element/ColumnList.js\";import RowList from\"./element/RowList.js\";import CreateButton from\"./element/CreateButton.js\";import PaginationCustom from\"./element/PaginationCustom.js\";import NavbarTop from\"../navbar/NavbarTop.js\";import Footer from\"../Footer.js\";import searchicon from\"../images/searchicon.png\";import\"./Notice.css\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Notice=()=>{const[dataList,setDataList]=useState([]);const[currentPage,setCurrentPage]=useState(1);const[searchKeyword,setSearchKeyword]=useState(\"\");const[isAdmin,setIsAdmin]=useState(false);const postsPerPage=10;const location=useLocation();const fetchData=async function(){let keyword=arguments.length>0&&arguments[0]!==undefined?arguments[0]:\"\";try{const endpoint=keyword?\"/notice?keyword=\".concat(encodeURIComponent(keyword)):\"/notice\";const response=await axios.get(endpoint);console.log(\"응답 데이터:\",response.data);if(response.data.admin!==undefined){setIsAdmin(response.data.admin);}setDataList(Array.isArray(response.data.posts)?response.data.posts:[]);}catch(error){console.error(\"There was an error fetching the posts!\",error);}};useEffect(()=>{fetchData();// 컴포넌트가 마운트될 때 데이터 가져오기\n},[]);useEffect(()=>{if(location.state&&location.state.newPost){console.log(\"새 게시글 추가:\",location.state.newPost);setDataList(prevDataList=>[location.state.newPost,...prevDataList]);}},[location.state]);const getNextNo=()=>{return dataList.length>0?Math.max(...dataList.map(post=>post.no))+1:1;};const indexOfLastPost=currentPage*postsPerPage;const indexOfFirstPost=indexOfLastPost-postsPerPage;const currentPosts=dataList.slice(indexOfFirstPost,indexOfLastPost);const handlePageChange=pageNumber=>{setCurrentPage(pageNumber);};const handleSearch=e=>{e.preventDefault();fetchData(searchKeyword);};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(NavbarTop,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"NoticeAll_layout\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"NoticeTop_layout\",children:/*#__PURE__*/_jsx(TitleBody,{title:\"\\uACF5\\uC9C0\\uC0AC\\uD56D\"})}),/*#__PURE__*/_jsx(List,{headersName:[\"제목\",\"작성자\",\"작성일\"],children:currentPosts.length>0?currentPosts.map((item,index)=>/*#__PURE__*/_jsxs(RowList,{children:[/*#__PURE__*/_jsx(ColumnList,{children:/*#__PURE__*/_jsx(Link,{to:\"/notice/PostView/\".concat(item.no),style:{textDecoration:\"none\"},children:/*#__PURE__*/_jsx(\"div\",{className:\"List_title\",children:item.title})})}),/*#__PURE__*/_jsx(ColumnList,{children:\"\\uAD00\\uB9AC\\uC790\"}),/*#__PURE__*/_jsx(ColumnList,{children:item.created_date})]},index)):/*#__PURE__*/_jsx(\"div\",{children:\"\\uAC8C\\uC2DC\\uAE00\\uC774 \\uC5C6\\uC2B5\\uB2C8\\uB2E4.\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"searchContent_layout\",children:[/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSearch,className:\"SearchForm\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"searchform_input\",type:\"text\",value:searchKeyword,onChange:e=>setSearchKeyword(e.target.value),placeholder:\"\\uAC80\\uC0C9\\uC5B4\\uB97C \\uC785\\uB825\\uD558\\uC138\\uC694\"}),/*#__PURE__*/_jsx(\"button\",{className:\"searchform_button\",type:\"submit\",children:/*#__PURE__*/_jsx(\"img\",{className:\"searchicon\",src:searchicon,alt:\"searchicon\",width:20,height:20})})]}),isAdmin&&/*#__PURE__*/_jsx(CreateButton,{nextNo:getNextNo()})]}),/*#__PURE__*/_jsx(\"div\",{className:\"PaginationCustom\",children:/*#__PURE__*/_jsx(PaginationCustom,{currentPage:currentPage,totalPages:Math.ceil(dataList.length/postsPerPage),onPageChange:handlePageChange})})]}),/*#__PURE__*/_jsx(Footer,{})]});};export default Notice;","map":{"version":3,"names":["React","useState","useEffect","Link","useLocation","axios","TitleBody","List","ColumnList","RowList","CreateButton","PaginationCustom","NavbarTop","Footer","searchicon","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Notice","dataList","setDataList","currentPage","setCurrentPage","searchKeyword","setSearchKeyword","isAdmin","setIsAdmin","postsPerPage","location","fetchData","keyword","arguments","length","undefined","endpoint","concat","encodeURIComponent","response","get","console","log","data","admin","Array","isArray","posts","error","state","newPost","prevDataList","getNextNo","Math","max","map","post","no","indexOfLastPost","indexOfFirstPost","currentPosts","slice","handlePageChange","pageNumber","handleSearch","e","preventDefault","children","className","title","headersName","item","index","to","style","textDecoration","created_date","onSubmit","type","value","onChange","target","placeholder","src","alt","width","height","nextNo","totalPages","ceil","onPageChange"],"sources":["C:/Users/가연/Desktop/Hackathon_real/Hackathon_JJIN/front-end/src/components/notice/Notice.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { Link, useLocation } from \"react-router-dom\";\r\nimport axios from \"axios\";\r\n\r\nimport TitleBody from \"./element/TitleBody.js\";\r\nimport List from \"./element/List.js\";\r\nimport ColumnList from \"./element/ColumnList.js\";\r\nimport RowList from \"./element/RowList.js\";\r\nimport CreateButton from \"./element/CreateButton.js\";\r\nimport PaginationCustom from \"./element/PaginationCustom.js\";\r\nimport NavbarTop from \"../navbar/NavbarTop.js\";\r\nimport Footer from \"../Footer.js\";\r\n\r\nimport searchicon from \"../images/searchicon.png\";\r\n\r\nimport \"./Notice.css\";\r\n\r\nconst Notice = () => {\r\n  const [dataList, setDataList] = useState([]);\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const [searchKeyword, setSearchKeyword] = useState(\"\");\r\n  const [isAdmin, setIsAdmin] = useState(false);\r\n  const postsPerPage = 10;\r\n  const location = useLocation();\r\n\r\n  const fetchData = async (keyword = \"\") => {\r\n    try {\r\n      const endpoint = keyword\r\n        ? `/notice?keyword=${encodeURIComponent(keyword)}`\r\n        : \"/notice\";\r\n      const response = await axios.get(endpoint);\r\n      console.log(\"응답 데이터:\", response.data);\r\n      if (response.data.admin !== undefined) {\r\n        setIsAdmin(response.data.admin);\r\n      }\r\n      setDataList(\r\n        Array.isArray(response.data.posts) ? response.data.posts : []\r\n      );\r\n    } catch (error) {\r\n      console.error(\"There was an error fetching the posts!\", error);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchData(); // 컴포넌트가 마운트될 때 데이터 가져오기\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (location.state && location.state.newPost) {\r\n      console.log(\"새 게시글 추가:\", location.state.newPost);\r\n      setDataList((prevDataList) => [location.state.newPost, ...prevDataList]);\r\n    }\r\n  }, [location.state]);\r\n\r\n  const getNextNo = () => {\r\n    return dataList.length > 0\r\n      ? Math.max(...dataList.map((post) => post.no)) + 1\r\n      : 1;\r\n  };\r\n\r\n  const indexOfLastPost = currentPage * postsPerPage;\r\n  const indexOfFirstPost = indexOfLastPost - postsPerPage;\r\n  const currentPosts = dataList.slice(indexOfFirstPost, indexOfLastPost);\r\n\r\n  const handlePageChange = (pageNumber) => {\r\n    setCurrentPage(pageNumber);\r\n  };\r\n\r\n  const handleSearch = (e) => {\r\n    e.preventDefault();\r\n    fetchData(searchKeyword);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <NavbarTop />\r\n      <div className=\"NoticeAll_layout\">\r\n        <div className=\"NoticeTop_layout\">\r\n          <TitleBody title=\"공지사항\" />\r\n        </div>\r\n        <List headersName={[\"제목\", \"작성자\", \"작성일\"]}>\r\n          {currentPosts.length > 0 ? (\r\n            currentPosts.map((item, index) => (\r\n              <RowList key={index}>\r\n                <ColumnList>\r\n                  <Link\r\n                    to={`/notice/PostView/${item.no}`}\r\n                    style={{ textDecoration: \"none\" }}\r\n                  >\r\n                    <div className=\"List_title\">{item.title}</div>\r\n                  </Link>\r\n                </ColumnList>\r\n                <ColumnList>관리자</ColumnList>\r\n                <ColumnList>{item.created_date}</ColumnList>\r\n              </RowList>\r\n            ))\r\n          ) : (\r\n            <div>게시글이 없습니다.</div>\r\n          )}\r\n        </List>\r\n        <div className=\"searchContent_layout\">\r\n          <form onSubmit={handleSearch} className=\"SearchForm\">\r\n            <input\r\n              className=\"searchform_input\"\r\n              type=\"text\"\r\n              value={searchKeyword}\r\n              onChange={(e) => setSearchKeyword(e.target.value)}\r\n              placeholder=\"검색어를 입력하세요\"\r\n            />\r\n            <button className=\"searchform_button\" type=\"submit\">\r\n              <img\r\n                className=\"searchicon\"\r\n                src={searchicon}\r\n                alt=\"searchicon\"\r\n                width={20}\r\n                height={20}\r\n              />\r\n            </button>\r\n          </form>\r\n          {isAdmin && <CreateButton nextNo={getNextNo()} />}\r\n        </div>\r\n        <div className=\"PaginationCustom\">\r\n          <PaginationCustom\r\n            currentPage={currentPage}\r\n            totalPages={Math.ceil(dataList.length / postsPerPage)}\r\n            onPageChange={handlePageChange}\r\n          />\r\n        </div>\r\n      </div>\r\n      <Footer />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Notice;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}